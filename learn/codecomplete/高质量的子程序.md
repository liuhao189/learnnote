# 高质量的子程序

什么是子程序，子程序是为实现一个特定的目的而编写的一个可被调用的方法或过程。

子程序的使用使得程序变得更加易读，更易于理解，比任何编程语言的任何功能特性都更容易。

## 创建子程序的正当理由

1、降低复杂度，创建子程序的一个最重要的原因，就是为了降低程序的复杂度。还要缩小代码规模，改善可维护性，提高正确性等。当内部循环或条件判断的嵌套层次很深时，就意味着需要从子程序中提取出新的子程序了。

2、引入中间，易懂的抽象，把一段代码放入一个命名恰当的子程序内，是说明这段代码用意最好的方法之一。getLeafName

3、避免重复代码，两端子程序中重复代码提取出来，将其中的相同部分放入新的子程序中，再让其余的代码来调用这个子程序。

4、支持子类化，覆盖简短而规整的子程序所需新代码的数量，要比覆盖冗长而邋遢的子程序更少。

5、隐藏顺序，把处理事件的顺序隐藏起来是一个好主意。

6、隐藏指针操作，指针操作的可读性通常都很差，而且也容易出错。通过把这些操作隔离在子程序内部，就可以把经理集中于操作的意图本身。

7、提高可移植性，可以用子程序来隔离程序中不可移植的部分，从而明确识别和隔离未来的移植工作。

8、简化复杂的布尔判断，理解程序的流程，通过并没有必要去研究那些复杂的布尔判断的细节，应该把这些判断放入函数中，以提高代码的可读性。把判断的细节放到一边了，一个具有描述性的函数名字可以概括出该判断的目的。

9、改善性能，通过使用子程序，可以只在一个地方优化代码。代码集中在一处可以更方便地查出哪些代码的运行效率低下，更容易修改。

10、确保所有的子程序都很小，有些事情写一个大的子程序来完成还会更好。

## 似乎过于简单而没必要写成子程序的操作

小子程序有很多优点，其一便是它们能够提高其可读性。此外，简单的操作常常会变成复杂操作。

## 总结

1、降低复杂度，引入中间的，易懂的抽象，简化复杂的逻辑判断，隔离复杂度，隐藏实现细节

3、避免代码重复，提高可移植性，改善性能，限制变化所带来的影响

4、支持子类化，隐藏顺序，隐藏指针操作

9、隐藏全局数据，形成中央控制点，促成可重用的代码，达到特定的重构目的

## 在子程序层上设计

内聚性是指子程序中各种操作之间联系的紧密程度。这样做的好处是得到跟高的可靠性。

功能内聚性，最强的也是最好的一种内聚性，让一个子程序仅执行一项操作。

顺序上的内聚性，指在子程序内包含有需要按特定顺序执行的操作，这些步骤需要共享数据，而且只有在全部执行完毕后才完成一项完整的功能。

通信上的内聚性，一个子程序中的不同操作使用了同样的数据，但不存在其它任何联系。

临时的内聚性，含有一些因为需要同时执行才放到一起操作的子程序。临时性的子程序看做是一系列事件的组织者。

其它类型的内聚性都是不可取的，都会导致代码组织混乱，难于调试，不便修改。

### 不可取内聚

过程上的内聚性，一个子程序中的操作是按特定的顺序进行的。因为它把一组操作赋予特定的顺序，而这些操作并不需要为了除此之外的任何原因而彼此关联。

逻辑上的内聚性，若干操作被放入同一个子程序中，通过传入的控制标志选择执行其中的一项操作。子程序的控制流或所谓逻辑是将这些操作放到一起的唯一原因。子程序代码仅由一系列的if语句或者case语句，以及调用其它子程序的语句组成，那么创建这样一个具有逻辑上的内聚性的子程序通常也是可以的。

巧合的内聚性是指子程序中的各个操作之间没有任何可以看到的关联，它也被称为无内聚性或混乱的内聚性。
