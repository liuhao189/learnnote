# 集成

集成指的是一种软件开发行为，将一些独立的软件组件组合成一个完整系统。

# 集成方式的重要性

如果按错误的顺序构建并集成软件，那么会难于编码、难于测试、难于调试。因为集成是在开发人员完成开发者测试之后才进行的，而且集成过程是与系统测试一起进行的。

# 集成频率-阶段式集成还是增量集成

## 阶段式集成

设计，编码，测试，调试各个类。将这些类组合为一个庞大的系统，测试并调试整个系统。

出现问题的位置的不确定性加上所有问题都是一下子出现这一事实，同时问题之间相互影响而导致其它问题，阶段式集成的另一个名称是大爆炸集成。

必须到项目的后期，所有的类都经过开发者测试之后，才能开始阶段式集成。避免错误大量涌现。

小程序或微型程序而言，阶段式集成或许是最佳方法。

## 增量集成

一小块一小块地编写并测试你的程序，然后一次一次地将它拼接起来，在这种一次一次的集成方式中。

1、开发一个小的系统功能部件，对它彻底地测试并调试，将它作为骨架

2、设计、编码、测试、调试某个类

3、将这个新的类集成到系统骨架上。测试并调试新类的结合体。

## 增量集成的益处

1、易于定位错误。新类明显脱不了干系，每次只需面对少量错误。出现的接口错误越多，那么增量集成对项目的优势越明显。很多项目中，开发人员花费多至50%的时间用于调试，使定位错误变容易，就能将调试的效率最大化，从而提高项目的质量与生产率。

2、及早在项目中取得系统级的成果。一旦代码被集成并运转起来，那么它看起来就像是很快就可用了。

3、改善对进度的监控，哪些功能是有的，哪些功能还没实现都是很明显的，管理层对进度会有更好的判断。

4、改善客户关系，增量式的build能频繁地产生进度增加的迹象。

5、更加充分地测试系统中的各个单元，项目及早开始集成，每开发一个类就继承一个类，而不是等到最后那个喧闹的集成狂欢节。

6、能在更短的开发进度计划内建造出整个系统，让一部分工作并行进行，当日历时间非常珍贵时，这一点就非常宝贵了。

# 增量集成的策略

使用阶段式集成时，无需安排项目中各组件的构建顺序。所有组件都是同时集成的，可以按任意顺序构建它们。

增量集成时，大多数系统要求先集成某些组件，再集成其它组件，为集成做计划也会影响为构建做计划，构建组件的顺序要合乎集成这些组件的顺序。

最佳解决方案总是为了满足特定项目的特定需求而制定的。

## 自顶向下集成

首先编写并集成的位于继承体系顶部的类。顶部类可能是主窗口，程序的控制循环，java中包含main的对象或类似的东西。为了演练该顶层类，需要编写一些存根，随着从上到下地集成各个类，这些存根类逐渐替换为实际的类。

重要的方面是，类之间的接口必须仔细定义。仔细地进行接口规格说明能减少这一问题。

能相对较早地测试系统的控制逻辑，较大的，概念上的设计问题就能及早暴露出来。

在项目早期就完成一个能部分工作的系统。

完成底层的设计细节之前就开始编码，一旦各个部分都开始进行相当底层的细节设计。

缺点：将棘手的系统接口的演练留到最后才进行，底层的问题冒上来影响顶层系统导致高层的变动，减少进行早期集成的收益。需对演练系统接口的类及早并仔细地开展开发者测试和性能分析。

需要很多存根类用于从上而下的集成工作。

## 自底向上集成

首先编写并集成位于底部的类，一次一次地添加底层类的方式，是一种增量集成策略。

错误的可能限制到正在被继承的那一个类上，因此容易定位错误，可以在项目的早期变开始集成。

主要问题在于：将重要的高层系统接口的继承工作留到最后才进行。如果系统在高层存在概念上的设计问题，必须对设计做重大修改，那么底层的一些工作多半就得扔掉了。

开始集成之前，已经完成整个系统的设计工作，如果不这么做。让底层细节驱动高层类的设计违反了信息隐藏原则和面向对象设计的原则，开始底层编码之时尚未完成高层类的设计，那么一定会出现大量的问题。

## 三明治集成

纯粹地自顶向下集成和纯粹地自底向上集成所具有的问题。

首先集成继承体系顶部的高层业务对象类，然后集成底部的与设备接口的类和广泛使用的工具类，这些高层类和底层类是三明治的那两片面包。稍后开始集成中间层的类。

## 风险导向的集成

风险导向的集成也称为困难部件优先集成法，它也趋向于先集成顶层类和底层类，将中间层类留后处理。

风险导向的集成中，需要先鉴别各个类对应的风险级别。

## 功能导向的集成

一次集成一项功能。如果待集成的共不止一个类，那么增量集成中的增量就大于一个类，稍微减少了渐进主义的益处，因为它降低了新错误的来源的确定程序。

通常你需要先搭好一个骨架，选择骨架的标准是它能支撑其它功能。

首先，它基本上不用脚手架。既然每个功能都是自成一体的，那它包含自己所需的支持代码。

每个新集成的功能都增加了系统的功能性，这证明项目正在坚定不移地前进。

功能导向的集成与面向对象设计能很好地协同工作。

## T型集成

选中某个特定的竖直块，对它及早开发并集成，这个功能块应该能从头到尾地演练系统，而且这个演练过程应该能找出系统设计所做的假设中的全部主要问题。

## 集成方法小结

自底向上，自顶向下，三明治，风险导向，功能导向，T型。这些方法中没有哪个是硬性条例，更多的是启发而非算法。

# Dayily Build 与冒烟测试

无论你选用哪种集成策略，daily build和冒烟测试都是软件集成的好方法。每天都将各个源文件编译，链接并组合为一个可执行程序，然后对这个程序进行冒烟测试。执行一种相对简单的检查，看看产品在运行时是否冒烟。

降低了低质量的风险，这是一种与不成功的集成或问题多多的集成相关的风险，通过每天对所有代码进行冒烟测试，可以防止质量问题遍布整个项目。

这一过程也便于诊断缺陷，它能提高士气，看到产品的工作成果能极大地提高士气。

频繁集成的另一个副作用是，它会使一些工作浮出水面。否则，未曾浮出水面的工作会转为项目末尾的坑，要花数周或数越才能挣扎解脱。

## 每日构建

频率：每日构建最关键的部分是daily/每天，可以把daily build视为项目的脉搏。

动作：检查失败的build，build的软件要能工作，如果软件不可用，那么build应被视为失败了，而修复它就成了优先级最高的事情。每个项目应该对失败建立自己的标准，这个标准需要设立一套质量等级，这套等级要严格到将使开发获得中断的缺陷包含在内，同时宽松到忽视细小的缺陷。

每天进行冒烟测试，冒烟测试应该从头至尾地演练整个系统，冒烟测试应该足够彻底，应该能暴露主要的问题。预防产品质量恶化和继承问题蔓延。

让冒烟测试与时俱进，冒烟测试必须随着系统的发展而发展。

将daily buid和冒烟测试自动化，只有自动化才能确保代码能build，冒烟测试能运行。

成立build小组，大多数项目中，看护dialy build并让冒烟测试保持更新的任务大到需要专门找个人来做。在大型项目中，需要多人全职为之工作。

仅当有意义时，才将修订加入build中，独立工作的开发人员编写代码的速度不会快到使系统每天都有明显的进展。需要在一大块代码上工作，然后猜进行集成。

别太久才将修订加入进来，开发人员接连两三天都不check in他做的改动，那么这名开发人员所做的工作就是有风险的。频繁地集成有迫使你将单一功能的构建分为若干阶段进行。

要求开发人员再把他的代码添加到系统之前，进行冒烟测试。

为即将添加到build的diam准备一块暂存区。

惩罚破坏build的人，大多数使用daily build的团队对破坏build的人加以惩罚。

在早上发布build，测试人员当天就能测试新鲜的build。自己没有过错而又必须待到很晚，build过程就会挫伤使其。

即使有压力，也要进行daily build和冒烟测试。进度压力变大时，维护daily build所需的工作看起来就行是奢侈的额外开销了。其实相反的观点才是对的，在压力下，开发人员可能不遵守某些纪律，他感到压力，想走构建的捷径。daily build 强调了纪律。

## 哪种项目能用dialy build过程

项目越大，增量集成酒越重要。近代历史上最复杂的软件项目window都成功地应用了daily build。

## 持续集成

持续一次的含义都是至少是每天一次。顶级的技术主管没有哪一个认为持续集成优于每天集成。

# 要点

构建的先后次序和集成的步骤会影响设计，编码，测试各类的顺序。

一个经过充分思考的集成顺序能减少测试的工作量，并使调试变容易。

增量集成有若干变型，而且，除非项目是微不足道的，任何一种形式的增量继承逗比阶段式集成好。

针对每个特定的项目，最佳的集成步骤通常是自顶向下，自底向上，风险导向及其它继承方法的某种组合，T型集成和竖直分块集成通常都能工作得很好。

daily build能减少集成的问题，提升开发人员的士气，并提供非常有用的项目管理信息。

