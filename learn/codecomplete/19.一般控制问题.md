# 布尔表达式

除了最简单的，要求语句按顺序执行的控制结构之外，所有的控制结构都依赖于布尔表达式的求值。

## 用true和false做布尔判断

在布尔表达式中应该用标识符true和false，而不要用0和1等数值。

## 隐式地比较布尔值与true和false

把表达式当做布尔表达式，可以写出更清晰的判断语句。

## 简化复杂的表达式

拆分复杂的判断并引入新的布尔变量。与其写一个庞大的，具有很多项的复杂判断，不如把中间结果赋给变量，可以执行一个更简单的判断。

把复杂的表达式做成布尔函数，某项判断需要重复做，或者会搅乱对程序主要流程的理解，可以把该判断的代码提取成一个函数，然后判断该函数的返回值。

用决策表代替复杂的条件。有时需要些一个复杂的判断，决策表代替if或case语句来执行判断可能非常有帮助。

## 编写肯定形式的布尔表达式

大多数人在理解一长串否定用语的时候都会觉得困难。if语句中，把判断条件从否定形式转换为肯定形式，并且互换if和else子句中的代码。

## 用括号使布尔表达式更清晰

与其依赖于所用语言的求值顺序，不如用括号更清楚地表达你的意图。使用括号降低了对代码阅读者的要求，

用一种简单的技术技巧来使括号对称，把布尔表达式全括在括号里面。计数法使得括号对称。

## 理解布尔表达式是如何求值的

一些语言的编译器采用短路或者懒惰求值，只求出那些必须的部分。一些语言的编译器会先计算布尔表达式中的每个项的值，然后再把这些项组合起来求出整个表达式的值。

## 按照数轴的顺序编写数值表达式

应该很好地组织数值判断，使其顺序与数轴上的点排列顺序相符。

## 与0比较的指导原则

编程语言把0用作很多目的，它是一个数值，是字符串的终止符，是空指针的取值，是枚举的第一个元素的取值，逻辑表达式中的false。

隐式地比较逻辑变量；把数与0相比较；C中显式地与比较零终止符；把指针与NULL相比较。

## 布尔表达式的常见问题

C家族语言中，应该把常量放在比较的左端。

Java中，应理解a==b和a.equals(b)之间的差异。a和b之间值的相等性。

## 复合语句

复合语句或语句块指的是一组语句，该组语句被视为一条单一的语句，用于控制程序流。可以通过在一组语句外面括上{和}来创建复合语句。

把括号对一起写出，先写块的开始和结束部分，然后再填充中间部分。

用括号来把条件表达清楚，要想读懂条件语句，就要先弄清楚哪条语句是跟在if判断后面的，可能会演变成复杂的块。

## 空语句

小心使用空语句，各自占一行，并且加以缩进。

为空语句创建一个DoNothing预处理宏或内联函数，子程序，简单地把控制权立即交还调用方子程序。

考虑如果换用一个非空的循环体，是否会让代码更清晰。空循环体代码的产生多数都是为了利用循环控制代码的副作用。

# 驯服危险的深层嵌套

过分深层的缩进，或者嵌套，至今仍然是产生混乱代码的罪魁祸首之一。很少有人能够理解超过3层的if嵌套。

可以重写设计if和else子句中执行的判断，或者把代码重构为更简单的子程序。

通过重复检测条件中的某一部分来简化嵌套的if语句。不能无偿地减少嵌套层次，作为减少嵌套层次的代价，必须要容忍使用一个更复杂的判断。

用break块来简化嵌套if，不常见。

把嵌套if转换成一组if-then-else语句，避免不必要的重复判断。

把嵌套if转换成case语句，可以用case语句重写一些判断，特别是那些含有整数的判断。

把深层嵌套的代码抽取出来放进单独的子程序，保留if-then-else分支显示决策的分支，然后把分支中的语句提取成单独的子程序。

使用一种面向对象的方法，抽象出基类，派生出子类。

重新设计深层嵌套的代码，面向对象的程序设计里出现case语句，说明代码没有做好分解。

## 总结

1、重复判断一部分条件。

2、转换成if-then-else

3、转换成case语句

4、把深层嵌套的代码提取成单独的子程序

5、使用对象和多态派生

6、用状态变量重写代码

7、用访问子句退出子程序，从而使代码的主要路径更为清晰

8、使用异常

9、完全重写设计深层嵌套的代码

## 结构化编程

结构化编程的核心思想很简单，那就是一个应用程序应该只采用一些单入单出的控制结构。指的就是一个代码块，只能从一个位置开始执行，并且只能结束于一个位置。

## 结构化编程的三个组成部分

### 顺序

顺序指一组按照先后顺序执行的语句。

### 选择

选择是一种有选择地执行语句的控制结构。if-then-else语句就是一个常见的例子。

### 迭代

迭代是一种使一组语句多次执行的控制结构。

## 控制结构与复杂度

控制结构对程序整体复杂度的影响非常大。

程序复杂度的一个衡量标准是，为了理解应用程序，你必须在同一时间记住的智力实体的数量。理解程序所需要花费的而精力。

### 降低复杂度的一般原则

通过计算决策点的数量来衡量复杂度。遇到if，while，repeat，for，and，or就+1，给case语句中的每一种情况加+1。
0-5个，子程序可能还不错；6-10个，得想半大简化子程序了；10+，把子程序的某一部分拆分成另一个子程序并调用它。

## 要点

使布尔表达式简单可读，非常有助于提高你的代码的质量

深层次的嵌套使得子程序变得难以理解，所幸的是，你可以相对容易地避免这么做。

结构化编程是一种简单并且仍然适用的思想，你可以通过把顺序、选择和循环三者组合起来而开发出任何程序。

将复杂度降低到最低水平是编写高质量代码的关键。



