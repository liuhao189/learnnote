# GPU加速能做什么

16ms优化：

1、大多数设备的刷新频率是60次/秒，超出16ms，页面的渲染就会出现卡顿现象，影响用户体验。

2、浏览器在一帧里面，会依次执行JS，Style，Layout，Paint和Composite。减少或避免layout，paint可以让页面不卡顿，动画效果更加流畅。

    JS：JS实现动画效果，DOM元素操作
    Style：计算样式，确定每个DOM元素应该应用什么CSS规则
    Layout：布局，计算每个DOM元素在最终屏幕上显示的大小和位置。reflow
    Paint：绘制，在多个层上绘制DOM元素的文字、颜色、图形、边框和阴影等。
    Composite：渲染层合并，按照合理的顺序合并图层然后显示到屏幕上。

利用GPU加速优先使用渲染层合并属性，避免layout，paint。

# 如何用Chrome devtools进行分析debug

浏览器渲染一个页面大致是按照下面这个步骤执行。

1、获取DOM并将其分割为多个层。

2、将每个层栅格化，并独立的绘制进位图中。

3、将这些位图作为纹理上传至GPU。

4、复合多个层来生成最终的屏幕图像。终极layer。

打开chrome devtool的Redering设置，开启Layer Borders。

黄色栅格，有动画3d变换的元素，表示放到了一个新的复合层中渲染。

蓝色的栅格，可以看做是比层更低一级的单位，这些区域就是RenderLayer。

如果黄色边框很多，那么肯定要查看一下原因了。

虽然我们最终在浏览器上看到的只是一个复印版，即最终只有一个层。但实际上一些DOM会因为一些规则被提升成独立的层，开启GPU加速，一旦被独立出来之后，变不会再影响其它DOM的布局，因为它改变之后，只是贴上了页面。

根据这个特点，可以把页面中一些布局经常变化的DOM提升到独立的层。那么，浏览器在之后的16ms中，只需要进行JS，Style和Composite。

# 如何开启GPU加速

下面这些因素都会引起Chrome创建合成层

1、3D或透视变化CSS属性

2、使用加速视频解码的video元素

3、拥有3D上下文或加速的2D上下文的canvas元素

4、混合插件

5、对自己的opacity做CSS动画或使用一个wekit变化的元素。

6、拥有加速CSS过滤器的元盛怒

7、元素A有一个z-index比自己小的元素B，且元素B是一个合成层。则元素A会提升为合成层。