<font size="4px">
# 打好基础

## 什么是软件构建

软件开发过程中的各种不同的活动，定义问题，需求分析，规划构建，软件架构，详细设计，编码和调试，单元测试，集成测试，集成，系统测试，保障维护。

构建活动主要是编码与调试，但也涉及详细设计，规划构建，单元测试，集成，集成测试等其它活动。

## 软件构建为何如此重要

提高软件的质量和开发者的生产效率都是十分重要的。构建活动是软件开发的主要组成部分；构建活动是软件开发中的核心活动；把主要精力集中于构建活动，可以大大提高程序员的生产率；构建活动的产物-源代码-对软件的唯一精确描述；构建活动是唯一一项确保会完成的工作。

## 用隐喻更充分地理解软件开发

不太理解的东西和一些你较为理解，且十分类似的东西做比较，可以对这些不太理解的东西产生更深刻的理解，这种使用隐喻的方法叫做建模。

模型的威力就在于其生动性，让你能够把握整个概念。它能隐隐地暗示各种属性，关系以及需要补充查证的部分。

应该用隐喻来提高你对编程问题和编程过程的洞察力，用它来帮助你思考编程过程中的活动，设计出更好的做事情的方法。

通过把软件的构建过程看做是房屋的建设过程，我们可以发现，仔细的准备是必要的，而大型项目和小型项目之间也是有差异的。

# 三思而后行，前期准备

在构建活动开始之前，准备工作要做周全。

使用高质量的实践方法是那些能创造高质量软件的程序员的共性，这些高质量的实践方法在项目的初期，中期，末期都强调质量。

准备工作的目标就是降低风险，一个好的项目规划者能够尽可能早地将主要的风险清除掉，以使项目的大部分工作能够尽可能平稳地运行。

## 辨明你所从事的软件的类型

前期准备预先要满足哪些条件，会随着不同项目种类，项目的正式程度，技术环境，员工能力以及项目的商业目标变化而变化。

序列化，需求稳定；设计直接且理解透彻；开发团队对应用领域非常熟悉；项目的风险很小；长期可预测很重要；后期改变需求，设计和编码的代码很可能较昂贵。

迭代：需求并没有理解透彻，不稳定；设计很复杂，或者很有挑战性；开发团队对于这一应用领域不熟悉；项目包含很多风险；长期可预测不重要；后期改变需求，设计和编码的代价很可能较低。

有些项目在前期准备上面花的时间太少了，结果使得在构建活动中遇到大量不必要的反复修改，同时阻碍了项目的稳步前进。

有些项目则预先做了太多的事情，固执地坚持原有的需求和计划。

## 问题定义的先决条件

开始构建之前，首先要满足的一项先决条件是，对这个系统要解决的问题作出清楚的陈述。问题定义。问题定义在具体的需求分析工作之前，而需求分析是对所定义的问题的深入调查。

## 需求的先决条件

需求详细描述软件系统应该做什么，这是达成解决方案的第一步。充分详尽地描述需求，是项目成功的关键，它甚至很可能比有效地构建技术更重要。

## 稳定需求的神话

稳定的需求是软件开发的圣杯，一旦需求稳定，项目就能以有序的，可预测的，平稳的方式，完成从架构到设计到编码到测试等一系列工作。

做这个项目的时间越长，对这个项目的理解就越深入，客户参与项目的时间越长，对项目的理解也就越深入。

## 在构建期间处理需求变更

评估你的需求质量，需求不够好，那么就停止工作，把它做好，再继续前进。

确保每一个人都知道需求变更的代价，进度和成本。

建立一套变更控制程序，建立一个正式的变更控制委员会。

使用能适应变更的开发方法，某些开发方法让你对需求变更作出响应的能力最大化。

放弃这个项目，如果需求特别糟糕，或者极不稳定，取消这个项目。

注意项目的商业案例，考虑自己的决定所带来的商业影响。

## 架构的先决条件

软件架构是软件设计的高层部分，是用于支撑更细节的设计的框架。架构的质量决定了系统的概念完整性，后者继而决定了系统的最终质量。

一个经过慎重考虑的架构为顶层到底层维护系统的概念完整性提供了必备的结构和体系，为程序员提供了指引，其细节程序与程序员的技能和手边的工作相配。将工作分为几个部分，使多个开发者或者多个开发团队可以独立工作。

## 架构的典型组成部分

### 程序组织

系统架构首先要以概括的形式对有关系统做一个综述。在架构中，你应该能发现对那些曾经考虑过的最终组织结构的替代方法的记叙，找到之所以选用最终的组织结构，而不是其它替代方案的理由。

架构应该定义程序的主要构造块，根据程序规模不同，各个构造块可能是单个类，也可能是由许多类组成的一个子系统。

应该明确定义各个构造块的责任，每个构造块应该负责某一个区域的事情，并且对其它构造块负责的区域知道得越少越好。

应该明确各个构造块的通信规则，对于每个构造块，架构应该描述它能直接使用哪些构造块，能间接使用哪些构造块，不能使用哪些构造块。

### 主要的类

架构应该详细定义所用的主要的类，应该指出每个主要的类的责任，以及该类如何与其它类交互。继承体系，状态转换，对象持久化的描述。

### 数据设计

架构应该描述所用到的主要文件和数据表的设计，应该描述曾经考虑过的其它方案，并说明做出选择的理由。

数据通常只应该由一个子系统或一个类直接访问。

架构应该详细定义所用的数据库的高层组织结构和内容，架构应该解释为什么单个数据库比多个数据库要好。

### 业务规则

如果架构依赖于特定的业务规则，那么它就应该详细描述这些规则，并描述这些规则对系统设计的影响。

### 用户界面设计

用户界面常常在需求阶段进行详细说明，没有，就应该在软件架构中进行详细说明。架构应该详细定义Web页面格式，GUI，命令行接口等主要元素。

### 资源管理

架构应该描述一份管理稀缺资源的计划，稀缺资源包括数据库连接，线程，句柄等。架构应估算在正常情况和极端情况下的资源使用量。

### 安全性

架构应该描述实现设计层面和代码层面的安全性的方法。如果先前尚未建立威胁模型，那么就应该在架构阶段建立威胁模型。在制定编码规范的时候应该把安全牢记在心。

### 性能

需求中详细定义性能目标，性能目标可以包括资源的使用，性能目标也应该详细定义资源（速度、内存，成本）之间的优先顺序。

### 可伸缩性

可伸缩性是指系统增长以满足未来需求的能力，架构应该描述系统如何应对用户数量，服务器数量，网络节点数量，数据库记录数，数据库记录的长度，交易量等的增长。

### 互动性

预计这个系统会与其它软件或硬件共享数据或资源，架构应该描述如何完成这一任务。

### 国际化/本地化

国际化是一项准备让程序支持多个locales的技术活动。

### 输入输出

输入输出IO是架构中值得注意的另一个领域，架构应该详细定义读取策略是先做，后做还是即时做。而且应该描述在哪一层检测IO错误，在字段、记录、流或者文件的层次。

### 错误处理

错误处理已被证明为现代计算机科学中最棘手的问题之一，不能武断地处理它。程序中高达90%的代码是用来处理异常情况，进行错误处理或做薄记工作，只有10%的代码是用来处理常规的情况。

错误处理是进行纠正还是仅仅进行检测。

错误检测是主动的还是被动的，主动地预测错误，被动地响应错误。

程序如何传播错误，程序一旦检测到错误，可以立刻丢弃引发该错误的数据，也可以把这个错误当成一个错误，并进入错误处理状态。

错误消息的处理有什么约定，没有详细定义一个一致地处理策略，用户界面看起来就会非常乱七八糟

如何处理异常，架构应该规定代码何时能够抛出异常，在什么地方捕获异常，如何记录这些异常，以及如何在文档中描述异常。

什么层次上处理错误

每个类在验证器输入数据的有效性方面需要负何种责任？每个类负责验证自己的数据的有效性，还是一组类负责验证整个系统的数据的有效性。

### 容错性

详细定义所期望的容错种类，容错是增强系统可靠性的一组技术，包括检测错误。

### 架构的可行性

设计师多半会关注系统的各种能力，也应该论证系统的技术可行性，任何一个方面不可行都会导致项目无法实施。

### 过度工程

健壮性是指系统在检测到错误后继续运行的能力，通常架构详细描述的系统会比需求详细描述的系统更健壮。

### 关于买还是造的决策

最激进的构建软件的解决方案是根本不去构建它，购买软件或免费下载开源的软件。

### 关于复用的决策

如果开发计划提倡使用已存在的软件，测试用例，数据格式或其它原料。如何对复用的软件进行加工，使之符合其它架构目标。

### 变更策略

对于程序员和用户来说，构建软件产品都是一个学习过程，所以在开发过程中产生很可能会发生变化。让架构足够灵活，能够适应可能出现的变化。

### 架构的总体质量

优秀的架构规格书的特点在于，讨论了系统中的类，讨论了每个类背后的隐藏信息，讨论了“采纳或排斥所有可能的设计替代方案”的根本理由。

架构应该是带有少许特别附加物的精炼且完整的概念体系，大型系统的本质问题是维持其概念完整性。

架构应该描述所有主要决策的动机，谨防“我们向来这么做”这种自认为有理的说法。

优秀的软件架构很大程度上是与机器和编程语言无关的，不可否认的是，你不能忽视构建的环境。

## 花费在前期准备上的时间长度

花费在问题定义，需求分析，软件架构上的时间，依据项目的需求而变化。一般说来，一个运作良好的项目会在需求，架构以及其它前期计划方面投入10%-20%的工作量和20%-30%的时间。

# 关键的构建决策

## 选择编程语言

使用熟悉的语言时，生产率比使用不熟悉的语言时要高。使用高级语言的程序员能比使用低级的语言的程序员达到更好地生产率和质量。

### 编程约定

在高质量软件中，你可以看到架构的概念完整性与其底层实现之间的关系。实现必须与架构保持一致，并且这种一致性是内在的，固有的。

任何大型的程序都需要一个控制结构，该结构可以统一编程语言的细节。否则会充斥各种不同的风格，显得邋遢，这些不同的风格将使你的大脑承受沉重负担。成功编程的一个关键就在于避免随意地变化，大脑可以专注于那些真正需要的变化。

### 你在技术浪潮中的位置

在成熟的技术环境下，浪潮的末尾，受益于丰富的软件开发基础设设施。

在技术浪潮的前期，情况正好相反，可选择的编程语言非常少，而那些语言往往有很多bug并且文档也很糟糕。

你如何面对自己的编程工作，取决于你在技术浪潮中所处的位置。

### 深入一种语言去编程的例子

大多数重要的编程原则并不依赖特定的语言，而依赖于你使用语言的方式。

### 选择主要的构建实践方法

决定在这么多的可选的实践方法中，你想要强调哪些。




