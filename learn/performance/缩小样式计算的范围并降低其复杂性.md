# 样式

通过添加和删除元素，更改属性，类或通过动画来更改DOM，全都会导致浏览器重新计算元素样式，在很多情况下还会对页面或页面的一部分进行布局。这就是所谓的计算样式的计算。

计算样式的第一部分是创建一组匹配选择器，这实际上是浏览器计算出给指定元素应用哪些类，伪选择器和ID。

第二部分设计从匹配选择器中获取所有样式规则，并计算出此元素的最终样式。在Blink中，这些过程的开销至少在目前是大致相同的。

    目前大约50%用来匹配选择器，另一半时间用于从匹配的规则中构建RenderStyle。

1、降低选择器的复杂性，使用以类为中心的方法，eg：BEM

2、减少必须计算器样式的元素数量。

## 降低选择器的复杂性

尽量使用类匹配。

```css
.box:nth-last-child(-n+1) .title {
  /* styles */
}

.final-box-title {
  /* styles */
}
```

## 减少要计算样式的元素数量

减少在元素更改时需要计算的工作量。计算元素的计算样式的最坏的开销情况是元素数量乘以选择器数量。

网页组件，样式计算在这方面稍有不同，默认情况下样式不会跨越Shadow DOM的边界。

## 测量样式重写计算的开销

performance即可查看。

## 使用块、元素、修饰符

BEM之类的编码方法实际上纳入了上述选择器匹配的性能优势，因为它建议所有元素都有单个类，并且在需要层次结构时也纳入了类的名称。

