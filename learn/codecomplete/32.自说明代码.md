# 自说明代码

只要文档标准合情合理，多数程序员都喜欢写文档，和布局一样，好的文档说明是程序员放在程序里面，体现其专业成就的标志。

# 外部文档

软件项目的文档涵盖了源码清单内外的各种信息，常见的形式有独立的文件或者单元开发文件夹。大型的正规项目，多数文档位于源码之外，外部结构文档通常比编码的层次更高，但比问题定义，需求和结构活动的层次低一些。

1、单元开发文件夹，是一种非正式文档，其中包含了供开发者在编程期间使用的记录。单元可指类，也可指程序包或组件。UDF主要用途是提供在其它地方没有说明的设计决策踪迹。

2、详细设计文档，详细设计文档是低层次的设计文档，描述在类层或子程序层的设计决定，曾考虑过的其它方法，以及所采用所选方案的理由。

## 编程风格做文档

与外部文档相比，内部文档嵌入于程序清单本身，是最详细的文档。位于源代码层次上，内部文档与代码的联系最密切，也是代码修正后最可能保持正确的那种文档。

代码层文档起主要作用的因素并非注释，而是好的编程风格。编程风格包括良好的程序结构，直率易懂的方法，有意义的变量名和子程序名，具名常量，清晰的布局，以及最低复杂度的控制流及数据结构。易读性的最高水平，自说明代码。

# 注释或不注释

注释不好只会帮倒忙。

1、高效注释之关键，重复代码毫无意义，要在高层次上抽象代码功能。

2、注释种类，
重复代码，只是用不同文字把代码的工作又描述一次，除了给读者增加阅读量外，没有提供更多信息。
解释代码，解释性注释通常用于解释复杂，有巧，敏感的代码块。如果代码过于复杂而需要解释，最好是改进代码，而不是添加注释。
代码标记，标记性注释并非有意留在代码中，它提醒开发者某处的工作未做完。
概述代码，若干行的意思以一两句话说出来，这种注释比重复性注释强多了。
代码意图说明，目的性注释用来指明一段代码的意图，它指出要解决的问题，而非解决的方法。
传达代码无法表达的信息，某些信息不能通过代码来表达，但又必须包含在源代码中，这种注释包括版权声明，保密要求，版本号等杂项信息。与代码设计有关的注意事项，相关要求或者架构文件的索引，联机参考链接，优化注记。

3、高效注释，注释占用太多时间通常归因于两点，一，注释的风格可能耗时或枯燥乏味，修改注释风格。二，说明程序干什么的话不好想出来，所以写注释太难，没有真正理解程序的信号。

采用不会打断或抑制修改的注释风格，任何太具想象力的风格维护起来都会烦人。单行注释用//，较长注释应用/*...*/。
用伪代码编程法减少注释时间，写代码之前以注释先勾勒出代码，你就会占尽先机。
将注释继承到你的开发风格中，把注释集成到开发风格的相反做法是，项目临结束才开始写注释。写注释成了专门的任务。
性能不是逃避注释的好借口，js等需要通过网络连接来传输的代码又表现出类似的问题。最终的解决方案都不是不要注释，而是创建区别于开发版的发布版代码。

4、最佳注释量

约每十条代码一个注释，这样的密度时长须清晰度最高。

## 注释技术

1、注释单行，对于好的代码，很少需要注释单条语句，要注释一行代码，有两个可能的理由，该行代码太复杂，因而需要及时；该行语句出过错，你想记下这个错。

a、不要随意添加无关注释。

b、行尾注释及其问题。行尾通常不会留下多少空间，要想保留注释就意味着注释要短，而不是尽可能地清晰。

c、不要对单行代码做行尾注释。难以对每行代码都写一句有意义的注释，多数行尾注释只是重复本行代码，起不了好的作用。

d、不要对多行代码做行尾注释。格式将很难说明它究竟应用于哪几行代码。

### 何时该用行尾注释

行尾注释用于数据声明，右边的空间有充裕，行尾注释对于数据声明的标注正合适。

避免行尾注释存放维护标记，这种注释能给人以满足感。但在产品代码中确实不应有这种注释。

用行尾注释标记块尾，用行尾注释标记大的代码块的结束位置是很合适的。

### 注释代码段

代码的意图，这样的注释维护起来相对容易，意图基本不会变更。

注释应表达代码的意图，包含代码中没有的信息，即$是命令字的结束符。

代码本身应尽力做好说明，代码自身总是应首要检查的说明记录。

注释代码段时应注重为何做而不是怎么做。

用注释为后面的内容做铺垫，好的注释会告诉读者后面有什么内容，读者只要浏览注释就能够了解代码在做什么。

让每个注释都有用，与其写很多注释，还不如对代码本身的可读性下功夫。

说明非常规做法，用了拐弯抹角的技巧，以求获得性能的提升。

别用缩略语，注释不应有歧义，应当易读而无须猜测缩写为何意。缩略语不利于可读性。

将主次注释区分开，想把不同层次的注释区分开。次注释前加入省略号，主注释以普通方式编排。最好的办法，将主注释所述的操作独立为子程序，子程序逻辑上应是扁平的，其所有行为都在同一个逻辑层次。

错误或语言环境独特点都要加注释，如果代码有误，这个错误也许没有记录，即使在什么地方记录过，你在代码中再记录一次也没坏处。

给出违背良好编程风格的理由，如果你不得不违背良好的编程风格，要解释器原因。以免善意的程序员去改善代码的风格，从而破坏你的代码，。

不要注释投机取巧的代码，应重写之。不要注释槽糕的代码，应重写之。

### 注释数据声明

变量声明的注释应给出变量名未表达出来的各种信息。

注释数值单位，不要觉得单位是不言自明的，新手不知道，工作于系统另一部分的人也不知道，要是程序经历实质性修改，也难保单位没有改动过。

对数值的允许范围给出注释，如果变量值有一个期望的范围，就该说明这个范围。

注释编码含义，如果语言支持枚举类型，请用它表达编码含义。不支持枚举，请用具名常量表示。

注释对输入数据的限制，数据的输入源包括传入的参数、文件和用户的直接键入。注释是说明子程序不愿接收某些数据的一种方法，而ASSERT是另一种说明有效范围的方法，采用这种方法更能让代码具备自检能力。

注释位标志，若变量用作位域，就应该对每个数据位的含义做出说明。

将与变量有关的注释通过变量名关联起来，如果注释提到特定的变量，应确保同步更新。变量名放在注释中。

注释全局变量，用了全局变量，要在其声明处作出注释。注释要指出该数据的目的，为和必须是全局数据。

P841



