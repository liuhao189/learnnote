# 控制循环

循环用来指代任意一种迭代控制结构，任一能够导致程序反复执行一段代码的结构。

## 选择循环的种类

计数循环执行的次数是一定的。

连续求值循环，预先并不知道将要执行多少次，会在每次迭代时检查是否应该结束。

无限循环，一旦启动就会一直执行下去。

迭代器循环对容器类里面的每个元素执行一次操作。

这些类型的循环首先是在灵活度上有差异，要么循环执行的次数是一定的，要么就在每次迭代的时候检查循环有没有完成。可以把检查放在循环的开始，中间或者结尾处。

## 什么是使用while循环

预先不知道循环要迭代多少次，那么就使用while循环。最主要的事项就是决定在循环开始处还是结尾处做检测。while还是do&&while。

## 什么时候用带退出的循环

带退出的循环就是终止条件出现在循环中间而不是开始或者末尾的循环。break或continue语句。比其它种类的循环都要更容易理解。避免N个半循环的情况。

## 何时使用for循环

需要一个执行次数固定的循环，for循环就是一个很好的选择。可以用for循环来执行那些不需要循环内部控制的简单操作。

## 使用foreach循环

foreach循环或其等价物很适用于对数组或者其它容器的各项元素执行操作。消除了循环内处理算法。

# 循环控制

循环错误：忽略或错误地对循环执行初始化、忽略了对累加变量或其它循环有关的变量执行初始化、不正确的嵌套，不正确的循环终止、忽略或错误地增加了循环变量的值、不正确的循环下标访问数组元素等。

首先，减少能影响循环各种因素的数量。其次，把循环内部当做一个子程序看待，把控制尽可能地放到循环体外。

## 进入循环

只从一个位置进入循环，各种不同的循环控制允许你在循环头，循环体或循环尾处执行测试。无须从多个位置进入。

把初始化代码紧放在循环前面，就近原则主张把相关的语句放在一起。

用while(true)表示无限循环，你也许有一个不需要终止的循环，或者有一个只在某一事件发生时才终止的循环。

在适当的情况下多使用for循环，for循环把循环的控制代码集中在一处，从而有助于写成可读性强的循环。

在while循环更适用的时候，不要使用for循环。

## 处理好循环体

用{和}把循环体中的语句括起来，任何时候都要在代码中使用括号。不会增加任何运行时所需的时间和存储空间，只会增加可读性，并且防止修改代码时出错。

避免空循环，

把循环内务操作要么放在循环的开始，要么放在循环的末尾。

一个循环只做一件事。每个循环只做一件事并且把它做好。合并提高效率需要注释和数据支撑。

## 退出循环

设法确认循环能够终止，基本要求。考虑正常的情况，端点，以及每一种异常情况。

使循环终止条件看起来很明显。把控制都放在一个地方。

不要为了终止循环而胡乱改动for循环的下标。

避免出现依赖于循环下标最终取值的代码，在循环终止后使用循环下标值是很不好的。

考虑使用安全计数器，安全计数器是一个变量，每次循环之后都递增它，以便判断该循环的执行次数是不是过多。

提前退出循环，break语句使循环通过正常的退出渠道退出，程序会从循环后面的第一条语句开始执行下去。continue不会让程序从循环中退出，而是让程序跳过循环体的余下部分。

考虑在while循环中使用break语句而不用布尔标记。

小心那些有很多break散步其中的循环。循环包含很多的break，意味着程序员对该循环的结构或对循环在围绕它的代码中的角色缺乏清晰的认识。

在循环开始处用continue进行判断，循环开始处做完条件判断后让代码越过剩下的循环体继续执行。

使用break和continue时要小心谨慎，使用break消除了把循环看作黑盒子的可能性。

## 检查端点

简单循环，需要注意三种情况，开始的情况，任意选择的中间情况，以及最终的情况。高效程序员和低效程序员之间的一项关键差别。

### 使用循环变量

用整数或枚举类型表示数组和循环的边界，循环计数器应该是整数。

在嵌套循环中使用有意义的变量名来提高可读性。有意义的下标名来明确你的用意。

用有意义的名字来避免循环下标串话。

把循环下标变量的作用域限制在本循环内。循环下标串话以及其它在循环外部使用循环下标的做法所带来的问题非常严重。

### 循环长度

循环要尽可能地短，以便能够一目了然。循环的长度限制在一页纸以内。简单代码这一原则，很少会写出超过20行的循环。

把嵌套限制在三层以内，超过三层，程序员对循环的理解能力会极大地降低。

把长循环的内容移到子程序里。

要让长循环格外清晰，单一出口，并且保持退出条件清晰无误。

# 循环和数组的关系

许多情况下，循环就是用来操纵数组的，而且循环计数器和数组下标一一对应。

# 要点

循环很复杂，保持循环简单将有助于别人阅读你的代码。

保持循环简单的技巧包括，避免使用怪异的循环，减少嵌套层次，让入口和出口一目了然，把内务操作代码放在一处。

循环下标很容易滥用，命名要准确，并且要把它们各自仅用与一个用途。

仔细地考虑循环，确认它在每一种情况下都运行正常，并且在所有可能的条件下都能退出。







